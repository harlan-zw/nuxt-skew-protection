---
title: Storage Configuration
description: Configure persistent storage for build assets across deployments.
---

## Introduction

Nuxt Skew Protection protects previous build chunks, to do this it uses the temporary storage `node_modules/.cache/nuxt/skew-protection` by default.

This may not be enough as this will get cleared at lower intervals depending on your CI. To get around
this it's recommended to configure a persistent storage driver that works with your platform and deployment workflow.

## CDN Usage

Note: If you already are using a CDN with Nuxt that has long cache times and you're not manually purging old assets, you may not need to configure persistent storage.

```ts
export default defineNuxtConfig({
  app: {
    cdnURL: 'https://cdn.example.com' // you may not need persistent storage
  }
})
```

## Filesystem Storage

For simplicity, filesystem storage is the easiest to set up. To use it effectively we need to configure our CI
to cache the `node_modules/.cache/nuxt/skew-protection` folder between builds.

We can do this in GitHub Actions like so:

```yaml
# ...
jobs:
  build:
    # ...
    steps:
      # ...
      - name: Cache skew-protection
        uses: actions/cache@v4
        with:
          path: node_modules/.cache/nuxt/skew-protection
          key: skew-protection-${{ github.ref_name }}-${{ github.run_id }}
          restore-keys: |
            skew-protection-${{ github.ref_name }}-
            skew-protection-
```

## Other Storage

The module supports various storage backends via [Unstorage](https://unstorage.dev/).

### Cloudflare KV

Create a new Cloudflare KV namespace and bind it to your Worker or Pages project.

```ts
export default defineNuxtConfig({
  skewProtection: {
    storage: {
      driver: 'cloudflare-kv-binding',
      binding: 'SKEW_STORAGE',
    }
  }
})
```

This requires that you have a `wrangler.toml` file in your project root and that you're authenticated with `wrangler login`.

### Vercel KV

```ts [nuxt.config.ts]
export default defineNuxtConfig({
  skewProtection: {
    storage: {
      driver: 'vercel-kv',
      url: process.env.KV_REST_API_URL,
      token: process.env.KV_REST_API_TOKEN
    }
  }
})
```

### Redis

```ts [nuxt.config.ts]
export default defineNuxtConfig({
  skewProtection: {
    storage: {
      driver: 'redis',
      host: process.env.REDIS_HOST || 'localhost',
      port: Number(process.env.REDIS_PORT) || 6379,
      password: process.env.REDIS_PASSWORD,
      db: 0,
      base: 'skew-protection'
    }
  }
})
```

## Retention Periods

If needed you can control how long versions are kept, by default the configuration is setup for optimal crawler compatibility.

```ts [nuxt.config.ts]
export default defineNuxtConfig({
  skewProtection: {
    // Keep versions for 45 days
    retentionDays: 45,
    // Keep maximum 15 versions
    maxNumberOfVersions: 15
  }
})
```

Cleanup happens **during build**, removing:

- Versions older than `retentionDays`
- Oldest versions beyond `maxNumberOfVersions`s
