---
title: useSkewProtectionCookie
description: Access the version tracking cookie.
---

Composable for accessing the skew protection version cookie (`__nkpv`).

## Usage

```ts
const versionCookie = useSkewProtectionCookie()
```

## Returns

- Type: `CookieRef<string>`

A reactive reference to the version cookie value.

```ts
const versionCookie = useSkewProtectionCookie()

console.log(versionCookie.value) // "abc123"

// Watch for changes
watch(versionCookie, (newVersion) => {
  console.log('Version changed to:', newVersion)
})
```

## Cookie Details

### Name

`__nkpv` (Nuxt Kit Protection Version)

### Value

The current buildId (e.g., `"abc123"`)

### Default Options

```ts
const defaultCookieOptions = {
  path: '/',
  sameSite: 'strict' as const,
  maxAge: 60 * 60 * 24 * 60, // 60 days
}
```

## Examples

### Display Current Version

```vue
<script setup>
const version = useSkewProtectionCookie()
</script>

<template>
  <div>
    <p>Current version: {{ version }}</p>
  </div>
</template>
```

### Compare with Latest

```vue
<script setup>
const userVersion = useSkewProtectionCookie()
const { latestVersion } = useSkewProtection()

const isOutdated = computed(() => {
  return userVersion.value !== latestVersion.value
})
</script>

<template>
  <div v-if="isOutdated" class="warning">
    You're on version {{ userVersion }}, but {{ latestVersion }} is available
  </div>
</template>
```

### Manual Cookie Update

```ts
const versionCookie = useSkewProtectionCookie()

// Update cookie manually
versionCookie.value = 'new-version-id'
```

::note
The cookie is automatically managed by the module. Manual updates are rarely needed.
::

### Debug Version Info

```vue
<script setup>
const versionCookie = useSkewProtectionCookie()
const { manifest } = useSkewProtection()

const versionInfo = computed(() => {
  if (!manifest.value?.skewProtection)
    return null

  const version = versionCookie.value
  const info = manifest.value.skewProtection.versions[version]

  return {
    version,
    timestamp: info?.timestamp,
    assetCount: info?.assets.length,
    isLatest: version === manifest.value.id
  }
})
</script>

<template>
  <div v-if="versionInfo" class="debug-panel">
    <h3>Version Debug Info</h3>
    <dl>
      <dt>Version ID:</dt>
      <dd>{{ versionInfo.version }}</dd>

      <dt>Build Time:</dt>
      <dd>{{ versionInfo.timestamp }}</dd>

      <dt>Asset Count:</dt>
      <dd>{{ versionInfo.assetCount }}</dd>

      <dt>Status:</dt>
      <dd>{{ versionInfo.isLatest ? 'Latest' : 'Outdated' }}</dd>
    </dl>
  </div>
</template>
```

### Custom Cookie Configuration

Configure cookie options in `nuxt.config.ts`:

```ts [nuxt.config.ts]
export default defineNuxtConfig({
  skewProtection: {
    cookie: {
      name: '__nkpv', // Default
      path: '/',
      sameSite: 'lax',
      secure: true, // HTTPS only
      maxAge: 60 * 60 * 24 * 30, // 30 days
      domain: '.example.com' // Share across subdomains
    }
  }
})
```

## Server-Side Usage

On the server, use the server utilities:

```ts
import { getSkewProtectionCookie, setSkewProtectionCookie } from 'nuxt-skew-protection/server'

export default defineEventHandler((event) => {
  // Get cookie
  const version = getSkewProtectionCookie(event)
  console.log('User version:', version)

  // Set cookie
  setSkewProtectionCookie(event, 'new-build-id')
})
```

See [Server Utilities](/docs/skew-protection/api/server-utilities) for more details.

## Notes

- Cookie is automatically set on every HTML request by middleware
- Value is always the **current buildId** from server perspective
- Client reads cookie to know their version
- Cookie persists across sessions (60 days by default)

## See Also

- [useSkewProtection](/docs/skew-protection/api/use-skew-protection) - Main composable
- [Server Utilities](/docs/skew-protection/api/server-utilities) - Server-side cookie management
- [Config Reference](/docs/skew-protection/api/config) - Cookie configuration options
